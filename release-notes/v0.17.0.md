# Release Notes: v0.17.0

This release introduces official support for Google Chrome, a new cross-browser compatibility layer using `webextension-polyfill`, significant improvements to the build system and tooling, and several bug fixes.

## üö® Breaking Changes

- **Build System:** The default build output directory has been changed from `dist/` to `dist-firefox/` to accommodate multi-browser builds. Projects or scripts relying on the old `dist/` path for Firefox builds will need to be updated. (Commit `daf23be3`)

## üöÄ New Features

- **Google Chrome Support:**
  - The extension is now fully compatible with Google Chrome. (Commit `daf23be3`, Pull Request `2ab9a87`)
  - Introduced a Chrome-specific manifest (`manifest-chrome.json`) using a service worker for the background script. (Commit `daf23be3`)
  - Implemented a dual build system that generates separate packages for Firefox (`dist-firefox/`) and Chrome (`dist-chrome/`). (Commit `daf23be3`)
  - Added new package scripts for browser-specific builds: `build:firefox`, `build:chrome`, and `build:all`. (Commit `daf23be3`)
  - Included separate `web-ext` configurations for Firefox and Chrome packaging. (Commit `daf23be3`)
- **Cross-Browser Compatibility Polyfill (`webextension-polyfill`):**
  - Integrated Mozilla's `webextension-polyfill` library, replacing the custom `browserShim`. This provides a more robust, standardized solution for cross-browser API compatibility. (Commits `67ee3750`, `857c4a7f`, `5e0a2e84`, `fcf6c7df`, `c4da7bb6`)
  - Added a standalone polyfill (`src/lib/polyfill-content.js`) for content scripts that do not use ES modules, ensuring promise-based browser API compatibility in environments like Chrome content scripts. (Commit `5ee06c2e`)

## ‚ú® Improvements & Refactorings

- **Logging System:**
  - Timestamps (formatted as `HH:mm:ss`) are now prepended to all logger outputs for improved debugging and event tracking. (Commits `78d7f770`, `5614da3b`; merged in `9e585215`)
- **Build System & Scripts:**
  - Updated build recording (`record-build.js`) and checksum comparison (`compare_checksums.py`) scripts to support the new dual browser (`dist-firefox/` and `dist-chrome/`) build structure. (Commits `490154cc`, `0b1922ae`)
  - The Firefox manifest file has been renamed from `manifest.json` to `manifest-firefox.json` for better clarity and consistency in the multi-browser setup. All related references have been updated. (Commit `d03e84ae`)
  - Refactored the injection method for `polyfill-content.js` in Chrome to be manifest-based instead of through the Vite build process, aligning better with extension standards. (Commit `e8e550dc`)
  - Minor code cleanup in `compare_checksums.py` by removing an unused variable. (Commit `48c72e7b`)
- **Storage API for Logging Configuration:**
  - Adapted `logConfig.js` to use `browser.storage.local` in service worker environments (e.g., Chrome background scripts) for storing logging configurations. It falls back to `localStorage` in other contexts, ensuring consistent behavior and Chrome compatibility. (Commit `4879e2ff`)

## üêõ Bug Fixes

- **Gem Name Extraction:**
  - Significantly improved the reliability of Gem name extraction from response containers, particularly addressing cases where the Gem UI elements load after prompts are sent or when initial detection fails. Gem information is now extracted on-demand at the time of history saving to prevent issues with outdated state and ensure accuracy. (Commits `fe5110dd`, `9d87bcd4`, `54b01d54`; merged in `5958c07f`)
- **Cross-Browser Service Worker Compatibility:**
  - Replaced `window` with `self` in `background.js` to ensure compatibility with service workers in Google Chrome, where `window` is not available. (Commit `38ad987b`)

## üõ†Ô∏è Chores & Tooling

- **Automated Version Bumping Script:**
  - Introduced a new script (`scripts/bump-version.js`) and a corresponding `pnpm bump <version | version-type>` command to automate the version update process across `package.json`, `manifest-firefox.json`, and `manifest-chrome.json`. (Commit `0ac56ec4`; merged in `cdc7dce2`)
  - Added JSDoc comments to `bump-version.js` for better clarity and maintainability. (Commit `587c4009`)
  - The `bump-version.js` script now throws an error if more than one argument is passed. (Commit `cc737c06`)
- **Dependency Management:**
  - Added Mozilla's `webextension-polyfill` as a project dependency. (Commit `67ee3750`)
- **Build Configuration Updates:**
  - Updated Vite (`vite.config.js`) configuration to correctly handle the `webextension-polyfill` and the `TARGET_BROWSER` environment variable for targeted builds. (Commits `fcf6c7df`, `daf23be3`)
- **Code & File Cleanup:**
  - Removed the custom `browserShim.js` as it has been fully replaced by `webextension-polyfill`. (Commit `c4da7bb6`)
  - Deleted the old default `web-ext-config.cjs` file, as browser-specific configurations are now in use. (Commit `f3a170ee`)
- **.gitignore Updates:**
  - Updated `.gitignore` to include `dist*` (which covers `dist-firefox/` and `dist-chrome/`) and specifically `dist-firefox` and `dist-chrome`. (Commits `43efceab`, `e3f6cb8d`)
- **Documentation:**
  - Updated the `README.md` with detailed instructions for Chrome installation and development workflows. (Commit `daf23be3`)
